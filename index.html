<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Simple Ecommerce Webpage</title>
</head>
<body>
	<header>
		<h1>My Simple Ecommerce Webpage</h1>
		<form>
			<label for="search-input">Search:</label>
			<input type="text" id="search-input">
			<button type="button" id="search-button">Go</button>
		</form>
	</header>
	<main>
		<div id="product-container"></div>
		<div class="product-card-template" style="display: none;">
			<img class="product-image" width="200">
			<div class="product-info">
				<h2 class="product-name"></h2>
				<p class="product-price"></p>
			</div>
		</div>
	</main>
	<script>
		// Sheety API endpoint
		const API_URL = "https://api.sheety.co/{SHEET_ID}/{SHEET_NAME}";

		// Function to fetch product data from Sheety API
		async function fetchProductData() {
			try {
				const response = await fetch(API_URL);
				const data = await response.json();
				return data;
			} catch (error) {
				console.error(error);
				return [];
			}
		}

		// Function to convert Sheety API data into product objects
		function parseProductData(data) {
			return data.map(item => {
				return {
					image: item.image,
					name: item.name,
					price: item.price
				};
			});
		}

		// Function to render product cards
		function renderProductCards(products) {
			// Get product container and card template
			const productContainer = document.getElementById("product-container");
			const productCardTemplate = document.querySelector(".product-card-template");

			// Clear existing product cards
			productContainer.innerHTML = "";

			// Render each product card
			products.forEach(product => {
				// Clone product card template and set its content
				const productCard = productCardTemplate.cloneNode(true);
				productCard.style.display = "flex";
				productCard.querySelector(".product-image").src = product.image;
				productCard.querySelector(".product-name").textContent = product.name;
				productCard.querySelector(".product-price").textContent = "$" + product.price;

				// Append product card to product container
				productContainer.appendChild(productCard);
			});
		}

		// Fetch and render product data on page load
		async function init() {
			const data = await fetchProductData();
			const products = parseProductData(data);
			renderProductCards(products);
		}

		// Search functionality
		const searchInput = document.getElementById("search-input");
		const searchButton = document.getElementById("search-button");

		searchButton.addEventListener("click", () => {
			const searchText = searchInput.value.toLowerCase();
			const filteredProducts = products.filter(product => product.name.toLowerCase().includes(searchText));
			renderProductCards(filteredProducts);
		});

		// Initialize the page
		init();
	</script>
</body>
</html>
